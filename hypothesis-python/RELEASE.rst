RELEASE_TYPE: patch

This patch factors out some common code in the shrinker for iterating
over pairs of data blocks. There should be no user-visible change.
